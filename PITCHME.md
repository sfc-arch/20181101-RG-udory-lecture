---?color=linear-gradient(to right, #c02425, #f0cb35)
@title[Introduction]

@snap[west headline text-white span-70]
符号化と復号
@snapend

@snap[south-west byline  text-white]
Arch B4 u-dory
@snapend

---

### 画像を撮って送る

- 様々な符号化処理
  - 読むときは復号

+++

#### 符号化とは？

> 符号理論において、符号（ふごう）またはコード（英: code）とは、シンボルの集合S, Xがあるとき、Sに含まれるシンボルのあらゆる系列から、Xに含まれるシンボルの系列への写像のことである。

@fa[meh-blank] ?????

+++

#### 符号の例

- モールス信号
- DNA
- UTF-8
- ASCII
- JPEG
- 抵抗器のカラーコード

---

### 画像の符号化

<br><br>

- 予測符号化
- 変換符号化
- ベクトル量子化
- エントロピー符号化

エントロピー量子化以外は画像の特徴を見越して行われる。

<br><br>

+++

#### 予測符号化

自然画像は隣接する画素に強い相関がみられることが多い。
したがって画素の情報を直接保存するよりも、
隣接する画素から次の画素の値を予測し、実際の値との差分を保存するほうが効率が良くなる。

- 一次元予測
- 二次元予測
  - 平面予測
  - 平均予測

+++

#### 変換符号化

<br><br>

自然画像は隣接する画素に強い相関が(ry
この特性を活かして画素の行列の変換を行うことで情報量を下げる。

- 離散フーリエ変換
- 離散コサイン変換

<br><br>

+++

#### ベクトル量子化

<br><br>

画像をブロックに分け、それと似たサンプルをコードブックから選び出す。
復元する際はコードブックのサンプルを組み合わせることで近似した画像が得られる。

<br><br>

+++

#### エントロピー符号化

<br><br>

データそのものを数学的に符号化する

- ハフマン符号化
- 算術符号化

<br><br>

---

### 予測符号化


近隣の画素から目的画素の値を予測し、実際の画素の値との差を符号とする方法。

- 一次元予測
  - 前値予測
- 二次元予測
  - 行列予測
  - 平均予測
  - 平面予測

+++

#### 前値予測

<br><br>

`\[
{X = A}
\]`

<br><br>

+++

#### 前値予測(例)

```
 90  90 86 91 101 114 136 136 ...
```

```
(90)  0 -4  5  10   3  22   0 ...
```

+++

#### 行列予測

<br><br>

`\[
 X = { (A + C) \over 2 }
\]`

<br><br>

+++

#### 行列予測(例)

```
 90  90 86 91 101 114 136 136 ...
 89  88 88 92  99 108 131 139 ..
```

```
(90)  0 -4  5  10   3  22   0 ...
 89  -1  1  3   3   2   9   6 ...
```

+++

#### 平面予測

<br><br>

`\[
 X = { A - B + C }
\]`

<br><br>

+++

#### フレーム間予測

動画では前後の画像の画素とも相関性がある。
これも予測に用いることができる。

---

### (直交)変換符号化

前置予測でも触れたように、

`\[
{X = A}
\]`

という予測が成立する。

+++

#### (直交)変換符号化

このとき任意の画素 `\( X_1 \)` とその右隣の画素 `\( X_2 \)` において

`\[
  X_1 \simeq X_2
\]`

である。つまり、 `\( X_1 \)` , `\( X_2 \)` を軸にとった座標を取り、
各点について `\(　\left( X_N , X_N+1 \right) \)` をプロットすると、
`\[ X_1 = X_2 \]` 
付近に点が集まる。

+++

#### (直交)変換符号化

(ここでグラフのイメージ)

+++

#### (直交)変換符号化

プロットが軸の付近に集まる  
  ＝偏りを持ったデータ
→ 情報量 少

+++

#### (直交)変換符号化

- 画像ごとに最適な回転行列が異なる
  - 都度求めるのと最大圧縮
  - → カルーネン・レーベン変換
- 自然画では **離散コサイン変換** (DCT) が近似的
  - JPEGはイラストなどが苦手

+++

#### JPEGでのDCTとMCU

- Minimum Coded Unit (MCU)
  - 画像をブロックで扱う際の単位
  - JPEG: 8x8

(ここでDCTの結果のサンプル)

---

### エントロピー符号化

符号のうち、

- 情報源のシンボルの出現確率に応じた符号語
- 長さの異なる符号語を使用
- 情報源を効率的に符号化

ハフマン符号や算術符号など

+++

#### エントロピー理論値

`\[
\sum \left( -P(X) \cdot \log_2 P(X) \right) \\
 \verb|where|　 P(X) = 配列中のXの出現確率
\]`

`a`が99コ、`b`が1コ出現する情報源ならば

`\[
-0.99 \cdot log_2{0.99} -0.01 \cdot log_2{0.01} \\
　　　 \simeq 0.0808
\]`

一文字あたりのエントロピーが0.08なので、100文字で8ビットまで理論上圧縮できる。

+++

### ハフマン符号

- パテントフリー
- 高効率
- HTTP2ヘッダーで利用される
- スキャン必要
- 出現順に符号を与える
- ハフマン木
  - 出現率低い順
- 符号表が必要

+++

#### ハフマン符号　１

情報源「`a b a c a b`」を圧縮することを考える

|   | a | b | c |
|---|---|---|---|
|出現数|3|2||1|
|出現確率|`$ 1\ over 2 $`|`$ 1\ over 3 $`|`$ 1\ over 6 $`|

